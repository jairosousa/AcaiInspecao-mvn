<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:p="http://primefaces.org/ui">
    <p:fieldset legend="Localização" toggleable="true">
            <h:panelGrid columns="6" >

                <h:outputLabel value="Latitude"/>
                <p:inputText id="latitude" size="50"
                             value="#{estabelecimentoBean.estabelecimento.latitude}"/>

                <h:outputLabel value="Longitude"/>
                <p:inputText id="longitude" size="50"
                             value="#{estabelecimentoBean.estabelecimento.longitude}"/>

                <p:commandButton id="opemMapa" 
                                 value="Obter Coordenadas" 
                                 action="#{estabelecimentoBean.obterCoordenadas()}"
                                 update="latitude longitude geoGmap"/>

                <h:outputLink id="openDialogLink" value="javascript:void(0)" onclick="PF('dlg').show();">
                    <h:graphicImage library="imagens" name="Maps.png" title="Ver no Mapa"/>
                </h:outputLink>
            </h:panelGrid>
    </p:fieldset><br />

    <p:dialog id="picture" widgetVar="dlg" header="Localização" resizable="false" showEffect="clip" hideEffect="clip" height="400" width="500"
              minimizable="true" maximizable="true">

        <p:gmap id="geoGmap" center="#{estabelecimentoBean.estabelecimento.latitude},#{estabelecimentoBean.estabelecimento.longitude}"
                zoom="16" type="ROADMAP" model="#{estabelecimentoBean.draggableModel}" style="width:100%;height:400px">
            <p:ajax event="markerDrag" listener="#{estabelecimentoBean.onMarkerDrag}" update="@form" />
        </p:gmap>

    </p:dialog>  

</ui:composition>